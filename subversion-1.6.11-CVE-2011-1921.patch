
Fixes for both CVE-2011-1921 and CVE-2011-1783.

https://bugzilla.redhat.com/show_bug.cgi?id=709114
https://bugzilla.redhat.com/show_bug.cgi?id=709112

--- subversion-1.6.11/subversion/libsvn_repos/authz.c.cve1921
+++ subversion-1.6.11/subversion/libsvn_repos/authz.c
@@ -746,6 +746,9 @@ svn_repos_authz_check_access(svn_authz_t
       return SVN_NO_ERROR;
     }
 
+  /* Sanity check. */
+  SVN_ERR_ASSERT(path[0] == '/');
+
   /* Determine the granted access for the requested path. */
   while (!authz_get_path_access(authz->cfg, repos_name,
                                 current_path, user,
--- subversion-1.6.11/subversion/mod_dav_svn/authz.c.cve1921
+++ subversion-1.6.11/subversion/mod_dav_svn/authz.c
@@ -51,6 +51,11 @@ allow_read(request_rec *r,
       return TRUE;
     }
 
+  /* Sometimes we get paths that do not start with '/' and 
+     hence below uri concatenation would lead to wrong uris .*/
+  if (path && path[0] != '/')
+    path = apr_pstrcat(pool, "/", path, NULL);
+
   /* If bypass is specified and authz has exported the provider.
      Otherwise, we fall through to the full version.  This should be
      safer than allowing or disallowing all accesses if there is a

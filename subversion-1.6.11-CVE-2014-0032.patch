
https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2014-0032

Backport of http://svn.apache.org/viewvc?view=revision&revision=r1557320

--- subversion-1.6.11/subversion/mod_dav_svn/repos.c.cve0032
+++ subversion-1.6.11/subversion/mod_dav_svn/repos.c
@@ -1655,6 +1655,18 @@ get_resource(request_rec *r,
 
       if (strcmp(parentpath, uri) == 0)
         {
+          /* Only allow GET and HEAD on the parentpath resource
+           * httpd uses the same method_number for HEAD as GET */
+          if (r->method_number != M_GET)
+            {
+              /* can't use r->allowed since the default handler isn't called */
+              apr_table_setn(r->headers_out, "Allow", "GET,HEAD");
+              
+              return dav_new_error(r->pool, HTTP_METHOD_NOT_ALLOWED, 0, 
+                                   "The URI does not contain the name "
+                                   "of a repository.");
+            }
+
           err = get_parentpath_resource(r, root_path, resource);
           if (err)
             return err;
